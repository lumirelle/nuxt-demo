// This file contains styles for the Shiki code block except syntax highlight.
// For example, font size, line height, focus style and so on.

// CSS Var
:root {
  --code-line-highlight-color: rgba(142, 150, 170, 0.14);
  --code-line-diff-add-color: rgba(16, 185, 129, 0.14);
  --code-line-diff-remove-color: rgba(244, 63, 94, 0.14);
  --code-line-number-color: rgba(115, 138, 148, 0.4);

  --code-offset: 1rem;
  --code-line-height: 1.7;
}

html.dark {
  --code-line-highlight-color: rgba(101, 117, 133, 0.16);
  --code-line-diff-add-color: rgba(16, 185, 129, 0.16);
  --code-line-diff-remove-color: rgba(244, 63, 94, 0.16);
}

// Styles for `ShikiJs` component
.shikijs {
  padding: var(--code-offset);

  /* Line numbers */

  &.show-line-numbers {
    counter-reset: step;
    counter-increment: step calc(var(--start, 1) - 1);

    .line::before {
      content: counter(step);
      counter-increment: step;
      width: 1rem;
      margin-right: 1.5rem;
      display: inline-block;
      text-align: right;
      color: var(--code-line-number-color);
    }
  }

  // Styles for `Shiki` component (Fit unwrap mode)
  code.shiki,
  .shiki code {
    display: block;
    line-height: var(--code-line-height);

    /* Styles for transformed results */

    /* Highlighted & Diff */

    .line {
      &.highlighted,
      &.diff {
        display: inline-block;
        margin: 0 calc(-1 * var(--code-offset));
        padding: 0 var(--code-offset);
        width: calc(100% + 2rem);
      }

      &.highlighted {
        background-color: var(--code-line-highlight-color);
        transition: background-color 0.5s;
      }

      &.diff {
        &.add {
          background-color: var(--code-line-diff-add-color);
        }

        &.remove {
          background-color: var(--code-line-diff-remove-color);
          opacity: 0.7;
        }
      }
    }

    /* Foucs */

    &.has-focused {
      .line:not(.focused) {
        opacity: 0.7;
        transition:
          filter 0.35s,
          opacity 0.35s;
        filter: blur(0.095rem);
      }
    }

    &:hover.has-focused {
      .line:not(.focused) {
        filter: blur(0);
        opacity: 1;
      }
    }
  }
}

// Dark styles
html.dark {
  code.shiki,
  .shiki code {
    background-color: var(--shiki-dark-bg) !important;

    .line span {
      color: var(--shiki-dark) !important;
    }
  }
}
